syntax = "proto3";

package command_events;

option go_package = "github.com/igrgin/pulsardb/transport/gen/command_events;command_events";

enum CommandEventType {
  SET = 0;
  GET = 1;
  DELETE = 2;
}

message CommandEventValue {
  oneof value {
    string string_value = 3;
    int64  int_value    = 4;
    double double_value = 5;
    bool   bool_value   = 6;
    bytes  bytes_value  = 7;
  }
}

message CommandEventRequest {
  uint64 eventId = 1;
  CommandEventType type = 2;
  string key = 3;  // Used for SET, GET, DELETE
  CommandEventValue cmd_value = 4; // Only used for SET
  map<string, string> extra_attributes = 5;

}

message CommandEventResponse {
  uint64 eventId = 2;
  CommandEventType type = 3;
  bool success = 4;
  CommandEventValue cmd_value = 5; // Only used for GET
  string error_message = 6;  // Only populated on error
}

service CommandEventService {
  rpc ProcessCommandEvent(CommandEventRequest) returns (CommandEventResponse);
}